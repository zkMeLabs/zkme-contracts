import { ethers, network } from 'hardhat';

let ZKBT_CONTRACT: string;
let ZKCONF_CONTRACT: string;
let ZKVERIFY_CONTRACT: string;
let ZKVERIFY_LITE_CONTRACT: string;
let ZKBT_CONTRACT_SSI: string;

if (network.name == "zeta") {
  ZKBT_CONTRACT = "0xf8E1973814E66BF03002862C325305A5EeF98cc1";
  ZKCONF_CONTRACT = "0xF58De9599C57bBAD68Fea0F39b73913daFcf0976";
  ZKVERIFY_CONTRACT = "0xA018F0593C1C3F62A68c3fc3B9D593961B207d96";
  ZKVERIFY_LITE_CONTRACT = "0x49D4B960Ad11967624307Fd8C9EFC92E0a7703a3";
} else if (network.name == "goerli") {
  ZKBT_CONTRACT = "0xc32d204404F33FF38Fee42394F7E671fd96314B3";
  ZKCONF_CONTRACT = "0x2F4db08ADeE48Ce0572E31e87D9a287Ab07a7773";
  ZKVERIFY_CONTRACT = "0xD231fF30102B34446035BA327ad4c596a5231cE3";
  ZKVERIFY_LITE_CONTRACT = "0x342f8DdBe0016c2CAEA271BdcB22F5065adf4e0C";
} else if (network.name == "tbnb") {
  ZKBT_CONTRACT = "0x270A49849E1400867a1343b4621c458d1F81190a";
  ZKCONF_CONTRACT = "0x05551c18ecFc2c458C671F44759FE4E998a5B97b";
  ZKVERIFY_CONTRACT = "0xf8E1973814E66BF03002862C325305A5EeF98cc1";
  ZKVERIFY_LITE_CONTRACT = "0xA018F0593C1C3F62A68c3fc3B9D593961B207d96";
} else if (network.name == "sepolia") {
  ZKBT_CONTRACT = "0xD923a27A8b7cf8C9f3dFA022851B503a55b095a9";
  ZKCONF_CONTRACT = "0x4DbA6d390d7b629397b22dd183ecaebd2aADb3a2";
  ZKVERIFY_CONTRACT = "0xF58De9599C57bBAD68Fea0F39b73913daFcf0976";
  ZKVERIFY_LITE_CONTRACT = "0xAB70E932a1Ae54193a1370Bf194625B9c2f4d98d";
} else if (network.name == "mantle") {
  ZKBT_CONTRACT = "0x270A49849E1400867a1343b4621c458d1F81190a";
  ZKCONF_CONTRACT = "0x05551c18ecFc2c458C671F44759FE4E998a5B97b";
  ZKVERIFY_CONTRACT = "0xf8E1973814E66BF03002862C325305A5EeF98cc1";
  ZKVERIFY_LITE_CONTRACT = "0xA018F0593C1C3F62A68c3fc3B9D593961B207d96";
} else if (network.name == "base") {
  ZKBT_CONTRACT = "0xD923a27A8b7cf8C9f3dFA022851B503a55b095a9";
  ZKCONF_CONTRACT = "0x4DbA6d390d7b629397b22dd183ecaebd2aADb3a2";
  ZKVERIFY_CONTRACT = "0xF58De9599C57bBAD68Fea0F39b73913daFcf0976";
  ZKVERIFY_LITE_CONTRACT = "0xAB70E932a1Ae54193a1370Bf194625B9c2f4d98d";
} else if (network.name == "fantom") {
  ZKBT_CONTRACT = "0x270A49849E1400867a1343b4621c458d1F81190a";
  ZKCONF_CONTRACT = "0x05551c18ecFc2c458C671F44759FE4E998a5B97b";
  ZKVERIFY_CONTRACT = "0xf8E1973814E66BF03002862C325305A5EeF98cc1";
  ZKVERIFY_LITE_CONTRACT = "0xA018F0593C1C3F62A68c3fc3B9D593961B207d96";
} else if (network.name == "optimism") {
  ZKBT_CONTRACT = "0x270A49849E1400867a1343b4621c458d1F81190a";
  ZKCONF_CONTRACT = "0x05551c18ecFc2c458C671F44759FE4E998a5B97b";
  ZKVERIFY_CONTRACT = "0xf8E1973814E66BF03002862C325305A5EeF98cc1";
  ZKVERIFY_LITE_CONTRACT = "0xA018F0593C1C3F62A68c3fc3B9D593961B207d96";
} else if (network.name == "arbitrum") {
  ZKBT_CONTRACT = "0x270A49849E1400867a1343b4621c458d1F81190a";
  ZKCONF_CONTRACT = "0x05551c18ecFc2c458C671F44759FE4E998a5B97b";
  ZKVERIFY_CONTRACT = "0xf8E1973814E66BF03002862C325305A5EeF98cc1";
  ZKVERIFY_LITE_CONTRACT = "0xA018F0593C1C3F62A68c3fc3B9D593961B207d96";
} else if (network.name == "avax_fuji") {
  ZKBT_CONTRACT = "0x270A49849E1400867a1343b4621c458d1F81190a";
  ZKCONF_CONTRACT = "0x05551c18ecFc2c458C671F44759FE4E998a5B97b";
  ZKVERIFY_CONTRACT = "0xf8E1973814E66BF03002862C325305A5EeF98cc1";
  ZKVERIFY_LITE_CONTRACT = "0xA018F0593C1C3F62A68c3fc3B9D593961B207d96";
} else if (network.name == "scroll_alpha_test") {
  ZKBT_CONTRACT = "0x270A49849E1400867a1343b4621c458d1F81190a";
  ZKCONF_CONTRACT = "0x05551c18ecFc2c458C671F44759FE4E998a5B97b";
  ZKVERIFY_CONTRACT = "0xf8E1973814E66BF03002862C325305A5EeF98cc1";
  ZKVERIFY_LITE_CONTRACT = "0xA018F0593C1C3F62A68c3fc3B9D593961B207d96";
} else if (network.name == "scroll_sepolia_test") {
  ZKBT_CONTRACT = "0x270A49849E1400867a1343b4621c458d1F81190a";
  ZKCONF_CONTRACT = "0x05551c18ecFc2c458C671F44759FE4E998a5B97b";
  ZKVERIFY_CONTRACT = "0xf8E1973814E66BF03002862C325305A5EeF98cc1";
} else if (network.name == "linea") {
  ZKBT_CONTRACT = "0x270A49849E1400867a1343b4621c458d1F81190a";
  ZKCONF_CONTRACT = "0x05551c18ecFc2c458C671F44759FE4E998a5B97b";
  ZKVERIFY_CONTRACT = "0xf8E1973814E66BF03002862C325305A5EeF98cc1";
  ZKVERIFY_LITE_CONTRACT = "0xA018F0593C1C3F62A68c3fc3B9D593961B207d96";
} else if (network.name == "mumbai") {
  ZKBT_CONTRACT_SSI = "0xA0D0bBEC266a4F02aBeE4f7F5b7F20751eC1deba";
  ZKBT_CONTRACT = "0xd1673ef638084042A14e45d7e63e2a47e9d14E10";
  ZKCONF_CONTRACT = "0x287b49a2312b7AF249fF35940d73FcA90A06bAE5";
  ZKVERIFY_CONTRACT = "0xd1bB4Ac9a5864ebd521eCcCD8f459cfdF13e25b8";
  ZKVERIFY_LITE_CONTRACT = "0xD19e3baaD6f69dED7872f4610D2981479d2DCCE9";
} else if (network.name == "manta_test") {
  ZKBT_CONTRACT = "0x270A49849E1400867a1343b4621c458d1F81190a";
  ZKCONF_CONTRACT = "0x05551c18ecFc2c458C671F44759FE4E998a5B97b";
  ZKVERIFY_CONTRACT = "0xf8E1973814E66BF03002862C325305A5EeF98cc1";
  ZKVERIFY_LITE_CONTRACT = "0xA018F0593C1C3F62A68c3fc3B9D593961B207d96";
} else {
  console.log(`Invalid network: ${network.name}`);
  process.exit(-1);
}

const OPERATORS: string[] = [
  "0x1E5Da5FB65789E12f98f71D9Afd7CC4a412d16e4",
  "0x92eb94cdab24FB4239a52Ce89453a4F79A56edCF",
  "0x4E97EACDf9EEFff1aCcBE04B886ab4b05F0C8292",
  "0x684B3DAc67b564F66993EEDd219559D8238A090F",
  "0x2a34f9A0Bfe6b739C98b86F231169EB343e6d5B1",
  "0x8E7c0F6c91AA6c37d3ED503d9D7c0175cdce53d1",
  "0x42fFEe73601113C2ACed814a533c060D76B41F7A",
  "0x5e72B4Ef8848B64EC852C5aE324aA084E37c58B7",
  "0xeFAAD0986664a9DbF5aA71A081Acb08982f7C512",
  "0xA9e470A80Af5C164afC2C3E2Ca282902F0Fb9C3f",
  "0xC35d7FA3B62C4b3872961daBa4ad4213Ae7C3D50",
  "0x102c1600c557a5718fE5382e2f570Ea0b911B676",
  "0xB5f502e2D211E38c34d29c0160e2701490FAB733",
  "0x13a0Ca19cAF22baB10729c1B0f8150248B006e9C"
];

const OPERATOR_ROLE = "0x97667070c54ef182b0f5858b034beac1b6f3089aa2d3188bb1e8929f4fa9b929";

async function main() {
  const signers = await ethers.getSigners();
  const deployer = await signers[0].getAddress();

  console.log(`Send txs to ${network.name} with account: ${deployer}`);


  const ZKBT = await ethers.getContractFactory('ZKMESBTUpgradeable');

  const zkbt = ZKBT.attach(ZKBT_CONTRACT);

  for (const addr of OPERATORS) {
    await zkbt.grantRole(OPERATOR_ROLE, addr);
  }

  console.log("granted zkmesbt operators");

  if (network.name == "mumbai") {
    const ssi = ZKBT.attach(ZKBT_CONTRACT_SSI);
    for (const addr of OPERATORS) {
      // await ssi.grantRole(OPERATOR_ROLE, addr);
    }
    console.log("granted zkme sbt ssi operators");
  }

  const CONF = await ethers.getContractFactory('ZKMEConfUpgradeable');
  const VERIFY = await ethers.getContractFactory('ZKMEVerifyUpgradeable');
  // const VERIFYLITE = await ethers.getContractFactory('ZKMEVerifyLiteUpgradeable');

  const conf = CONF.attach(ZKCONF_CONTRACT);
  const verify = VERIFY.attach(ZKVERIFY_CONTRACT);
  // const verify_lite = VERIFYLITE.attach(ZKVERIFY_LITE_CONTRACT);

  for (const addr of OPERATORS) {
    await conf.grantOperator(addr);
  }

  console.log("granted zkme conf operators");

  for (const addr of OPERATORS) {
    await verify.grantOperator(addr);
  }

  console.log("granted zkme verify operators");

  // for (const addr of OPERATORS) {
  //   await verify_lite.grantOperator(addr);
  // }

  // console.log("granted zkme verify lite operators");


  console.log("all granted");
}

main().catch(error => {
  console.log(error);
  process.exitCode = 1;
})